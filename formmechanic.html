<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-translate="mechanicRegisterTitle">Mechanic Registration - Your Vehicles Care</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* ==========================================================================
           1. CSS Variables & Theming (Copied from index.html)
           ========================================================================== */
        :root {
            --background: #ffffff;
            --foreground: #020817;
            --card: #ffffff;
            --card-foreground: #020817;
            --primary: #1e40af; 
            --primary-foreground: #f9fafb; 
            --primary-light: #3b82f6; 
            --muted: #f3f4f6;
            --muted-foreground: #6b7280;
            --accent: #eef2ff;
            --accent-foreground: #3730a3;
            --destructive: #dc2626;
            --border: #e5e7eb;
            --ring: #3b82f6;
            --radius: 0.75rem;
            --highlight: #f59e0b;
            --header-background: rgba(2, 8, 23, 0.8);
            --header-background-scrolled: rgba(2, 8, 23, 0.85);
            --header-text: #ffffff;
            --footer-background: #0f172a;
            --footer-text: #94a3b8;
        }

        .dark {
            --background: #020817;
            --foreground: #f8fafc;
            --card: #0f172a;
            --card-foreground: #f8fafc;
            --primary: #60a5fa;
            --primary-foreground: #020817;
            --primary-light: #93c5fd;
            --muted: #1e293b;
            --muted-foreground: #94a3b8;
            --accent: #312e81;
            --accent-foreground: #e0e7ff;
            --destructive: #ef4444;
            --border: #1e293b;
            --ring: #60a5fa;
            --header-background: rgba(2, 8, 23, 0.6);
            --header-background-scrolled: rgba(2, 8, 23, 0.85);
            --footer-background: #020817;
            --secondary: #1e293b; 
        }

        /* ==========================================================================
           2. General Body & Typography Styles (Copied from index.html)
           ========================================================================== */
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--background);
            color: var(--foreground);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            color: var(--card-foreground);
            font-weight: 700;
        }

        /* ==========================================================================
           3. Header & Navigation (Copied from index.html)
           ========================================================================== */
        header {
            position: sticky;
            top: 0;
            z-index: 50;
            background-color: var(--header-background);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            color: var(--header-text);
            border-bottom: 1px solid transparent;
        }

        header.scrolled {
             background-color: var(--header-background-scrolled);
             box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dark header.scrolled {
             border-bottom: 1px solid var(--border);
        }

        header nav a {
            position: relative;
            color: var(--header-text);
            padding: 8px 4px;
            transition: color 0.3s ease;
        }
        
        header nav a:hover {
            color: var(--primary-light);
        }

        header nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background-color: var(--primary-light);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        header nav a:hover::after, header nav a.active::after {
            width: 100%;
        }

        /* Mobile Navigation */
        .mobile-nav-slider {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background-color: var(--card);
            z-index: 200;
            transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
        }
        .mobile-nav-slider.open {
            right: 0;
        }
        .mobile-nav-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 199;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .mobile-nav-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        /* ==========================================================================
           4. Form Specific Styles (Adapted for new theme)
           ========================================================================== */
        .theme-toggle {
            background: var(--muted);
            color: var(--muted-foreground);
            border: 1px solid var(--border);
        }
        .theme-aware-input {
            color: var(--foreground) !important;
            background-color: var(--muted) !important;
            border-color: var(--border);
        }
        .theme-aware-input::placeholder {
            color: var(--muted-foreground);
            opacity: 1;
        }

        .main-container {
            max-width: 960px;
            margin-left: auto;
            margin-right: auto;
            padding: 2rem 1rem;
        }
        
        .form-header h1 {
            color: var(--card-foreground);
            font-size: 2.25rem;
        }
        .form-header p {
            color: var(--muted-foreground);
            font-size: 1.125rem;
        }
        
        .form-wrapper {
            background-color: var(--card);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
        }

        .form-step { display: none; }
        .form-step.active { display: block; }
        
        .form-step h2 {
            font-size: 1.5rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        label {
            color: var(--card-foreground);
            font-weight: 500;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            background-color: var(--muted);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            outline: none;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="date"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--ring);
            box-shadow: 0 0 0 2px var(--ring);
        }
        
        .form-checkbox, .form-radio {
            accent-color: var(--primary);
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
            width: 100%;
            margin-top: 1rem;
        }
        .btn-primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }
        .btn-primary:hover {
            background-color: var(--primary-light);
            border-color: var(--primary-light);
        }
        .btn-secondary {
            background-color: var(--muted);
            color: var(--muted-foreground);
            border-color: var(--border);
        }
        .btn-secondary:hover {
            background-color: var(--accent);
            border-color: var(--accent-foreground);
        }
        
        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: var(--muted);
            border-radius: var(--radius);
            overflow: hidden;
            height: 1.5rem;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--primary);
            transition: width 0.4s ease-in-out;
        }
        .progress-text {
            position: absolute;
            width: 100%;
            text-align: center;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary-foreground);
            mix-blend-mode: difference;
            filter: invert(1) grayscale(1) contrast(100);
            font-weight: 600;
        }

        /* Message Box */
        .message-box {
            position: fixed; inset: 0;
            background-color: rgba(0,0,0,0.6);
            z-index: 1000;
            display: flex; align-items: center; justify-content: center;
        }
        .message-box-content {
            background-color: var(--card);
            padding: 2rem;
            border-radius: var(--radius);
            text-align: center;
            max-width: 400px; width: 90%;
        }
        .message-box-content .btn-primary { width: auto; }
        
        /* Tag selection styles */
        .selected-items-container {
            display: flex; flex-wrap: wrap; gap: 0.5rem;
            padding: 0.5rem; border: 1px solid var(--border);
            border-radius: var(--radius); background-color: var(--muted);
            min-height: 42px; align-items: center;
        }
        .selected-item-tag {
            display: inline-flex; align-items: center;
            background-color: var(--accent); color: var(--accent-foreground);
            font-weight: 500; padding: 0.25rem 0.75rem;
            border-radius: 9999px;
        }
        .selected-item-tag button { margin-left: 0.5rem; background: none; border: none; cursor: pointer; color: var(--accent-foreground); }

        .hidden { display: none !important; }

    </style>
</head>
<body class="bg-muted">
    <!-- Header -->
    <header class="py-2">
        <div class="container mx-auto flex items-center justify-between px-4">
            <a href="index.html" class="flex items-center flex-shrink-0" aria-label="Your Vehicles Care Home">
                <img src="yvc.png" alt="Your Vehicles Care Logo" class="h-14 w-auto"> 
            </a>

            <nav id="desktop-nav" class="hidden lg:flex items-center gap-x-3 xl:gap-x-6 text-sm font-semibold" aria-label="Main Navigation">
                <a href="index.html#hero" class="nav-link">Home</a>
                <a href="index.html#services" class="nav-link">Services</a>
                <a href="index.html#testimonials" class="nav-link">Reviews</a>
                <a href="index.html#gallery" class="nav-link">Gallery</a>
                <a href="index.html#faq" class="nav-link">FAQ</a>
                <a href="formmechanic.html" class="nav-link active">Join Us</a>
            </nav>

            <div class="flex items-center gap-x-2">
                <button id="theme-toggle" class="theme-toggle h-10 w-10 rounded-full flex items-center justify-center text-xl" aria-label="Toggle Dark Mode">
                    <i class="fas fa-sun"></i>
                </button>
                <button class="lg:hidden mobile-menu-button h-10 w-10 rounded-full flex items-center justify-center text-2xl" aria-label="Toggle Mobile Menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>
    
    <!-- Mobile Navigation -->
    <div class="mobile-nav-overlay"></div>
    <div class="mobile-nav-slider p-6 flex flex-col">
        <div class="flex justify-between items-center mb-8">
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200">Menu</h3>
            <button class="mobile-menu-close text-2xl text-gray-500 hover:text-red-500 transition-colors" aria-label="Close Menu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="flex flex-col gap-y-4 text-lg font-semibold text-gray-700 dark:text-gray-300">
             <a href="index.html#hero" class="nav-link">Home</a>
            <a href="index.html#services" class="nav-link">Services</a>
            <a href="index.html#testimonials" class="nav-link">Reviews</a>
            <a href="index.html#gallery" class="nav-link">Gallery</a>
            <a href="index.html#faq" class="nav-link">FAQ</a>
            <a href="formmechanic.html" class="nav-link active">Join Us</a>
        </nav>
    </div>

    <div class="main-container">
        <header class="text-center mb-8 form-header">
            <h1 data-translate="mechanicRegisterHeading">Mechanic Registration</h1>
            <p id="formSubheading"></p>
        </header>

        <div class="form-wrapper">
            <div class="progress-container mb-6">
                <div class="progress-bar" id="progressBar"></div>
                <div class="progress-text" id="progressText">Step 1 of 5</div>
            </div>

            <form id="mechanicRegistrationForm">
                <div id="step1" class="form-step">
                    <h2>Personal Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="firstName">First Name:</label>
                            <input type="text" id="firstName" name="firstName" required placeholder="John">
                        </div>
                        <div>
                            <label for="lastName">Last Name:</label>
                            <input type="text" id="lastName" name="lastName" required placeholder="Doe">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="address">Address:</label>
                        <input type="text" id="address" name="address" required placeholder="123 Main St, Anytown">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="city">City:</label>
                            <input type="text" id="city" name="city" required placeholder="Indore">
                        </div>
                        <div>
                            <label for="zipCode">Zip Code:</label>
                            <input type="text" id="zipCode" name="zipCode" required placeholder="452001">
                        </div>
                    </div>
                    <div class="location-group">
                        <div id="locationInstruction">Please click "Get Location" or enter manually.</div>
                        <label for="location">Location:</label>
                        <div class="flex gap-2 items-center">
                            <input type="text" id="location" name="location" placeholder="Location not set" required />
                            <button type="button" id="getLocationBtn" class="btn btn-secondary !w-auto !mt-0">Get Location</button>
                        </div>
                        <div class="error-message" id="locationError"></div>
                    </div>
                    <button type="button" class="btn btn-primary next-step-btn">Proceed to Next Step</button>
                </div>

                <div id="step2" class="form-step hidden">
                    <h2>Contact & Verification</h2>
                    <div class="mb-4">
                        <label for="mobileNumber">Phone Number (Mobile):</label>
                        <input type="tel" id="mobileNumber" name="mobileNumber" required pattern="[0-9]{10}" title="Please enter a 10-digit phone number" placeholder="e.g., 9876543210">
                    </div>
                    <div class="mb-4">
                        <label for="altContactNumber">Alternative Contact Number (Optional):</label>
                        <input type="tel" id="altContactNumber" name="altContactNumber" pattern="[0-9]{10}" title="Please enter a 10-digit phone number" placeholder="Optional">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="drivingLicenseNumber">Driving License Number:</label>
                            <input type="text" id="drivingLicenseNumber" name="drivingLicenseNumber" required>
                        </div>
                        <div>
                            <label for="drivingLicenseExpiry">Driving License Expiry Date:</label>
                            <input type="date" id="drivingLicenseExpiry" name="drivingLicenseExpiry" required>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary next-step-btn">Proceed to Next Step</button>
                    <button type="button" class="btn btn-secondary prev-step-btn">Previous Step</button>
                </div>

                <div id="step3" class="form-step hidden">
                    <h2>Service Capabilities</h2>
                    <div class="mb-4">
                        <label>Types of Vehicles Serviced:</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2">
                           <label class="inline-flex items-center"><input type="checkbox" name="vehicleType" value="2-Wheelers" class="form-checkbox"><span class="ml-2">2-Wheelers</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="vehicleType" value="3-Wheelers" class="form-checkbox"><span class="ml-2">3-Wheelers</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="vehicleType" value="4-Wheelers" class="form-checkbox"><span class="ml-2">4-Wheelers</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="vehicleType" value="Commercial" class="form-checkbox"><span class="ml-2">Commercial</span></label>
                        </div>
                    </div>
                    <!-- ADDED BACK: Specialized Services Section -->
                    <div class="mb-4">
                        <label>Specialized Services Offered:</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 mt-2">
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="AC Repair & Service" class="form-checkbox"><span class="ml-2">AC Repair</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Engine Overhaul/Repair" class="form-checkbox"><span class="ml-2">Engine Repair</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Transmission Repair" class="form-checkbox"><span class="ml-2">Transmission</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Brake System Repair" class="form-checkbox"><span class="ml-2">Brake System</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Suspension & Steering" class="form-checkbox"><span class="ml-2">Suspension</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Electrical & Diagnostics" class="form-checkbox"><span class="ml-2">Electrical</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Battery Services" class="form-checkbox"><span class="ml-2">Battery Services</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Denting & Painting" class="form-checkbox"><span class="ml-2">Denting/Painting</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Tire Services" class="form-checkbox"><span class="ml-2">Tire Services</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Key & Locksmith" class="form-checkbox"><span class="ml-2">Key & Locksmith</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="specializedService" value="Hybrid/EV Expertise" class="form-checkbox"><span class="ml-2">Hybrid/EV</span></label>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label>Tools & Equipment Owned:</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2">
                           <label class="inline-flex items-center"><input type="checkbox" name="toolsOwned" value="Jump Starter" class="form-checkbox"><span class="ml-2">Jump Starter</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="toolsOwned" value="Diagnostic Scanner" class="form-checkbox"><span class="ml-2">Diagnostic Scanner</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="toolsOwned" value="Basic Tools" class="form-checkbox"><span class="ml-2">Basic Tools</span></label>
                           <label class="inline-flex items-center"><input type="checkbox" name="toolsOwned" value="Advanced Tools" class="form-checkbox"><span class="ml-2">Advanced Tools</span></label>
                        </div>
                        <div id="selectedToolsDisplay" class="selected-items-container mt-2"></div>
                        <input type="hidden" id="hiddenToolsOwned" name="selectedTools">
                    </div>
                     <h2>Availability</h2>
                     <div class="mb-4">
                        <label>Preferred Working Days:</label>
                         <div class="flex flex-wrap gap-4 mt-2">
                            <label class="inline-flex items-center"><input type="radio" name="availableDays" value="Mon-Fri" class="form-radio" required><span class="ml-2">Mon-Fri</span></label>
                            <label class="inline-flex items-center"><input type="radio" name="availableDays" value="Weekends only" class="form-radio"><span class="ml-2">Weekends only</span></label>
                            <label class="inline-flex items-center"><input type="radio" name="availableDays" value="All days" class="form-radio"><span class="ml-2">All days</span></label>
                         </div>
                    </div>
                    <div class="mb-4">
                        <label for="timeSlots">Time slots:</label>
                        <input type="text" id="timeSlots" name="timeSlots" placeholder="e.g., 9 AM - 6 PM, Flexible, On-call">
                    </div>
                    <div class="mb-4">
                        <label>Available for emergency calls (24/7)?</label>
                         <div class="flex gap-4 mt-2">
                            <label class="inline-flex items-center"><input type="radio" name="emergencyAvailable" value="Yes" class="form-radio"><span class="ml-2">Yes</span></label>
                            <label class="inline-flex items-center"><input type="radio" name="emergencyAvailable" value="No" class="form-radio"><span class="ml-2">No</span></label>
                         </div>
                    </div>
                    <button type="button" class="btn btn-primary next-step-btn">Proceed to Next Step</button>
                    <button type="button" class="btn btn-secondary prev-step-btn">Previous Step</button>
                </div>

                <div id="step4" class="form-step hidden">
                    <h2>Professional & Legal Details</h2>
                    <div class="mb-4">
                        <label for="serviceVehicle">Vehicle Owned for Service:</label>
                        <input type="text" id="serviceVehicle" name="serviceVehicle" placeholder="e.g., Motorcycle, Scooter, Car, Van">
                    </div>
                    <div class="mb-4">
                        <label for="upiId">UPI ID:</label>
                        <input type="text" id="upiId" name="upiId" placeholder="yourname@bank" required />
                    </div>
                    <div class="mb-4">
                        <label for="upiName">Name for UPI ID:</label>
                        <input type="text" id="upiName" name="upiName" placeholder="Name associated with your UPI ID" required />
                    </div>
                    <div class="mb-4">
                        <label for="references">References (Optional):</label>
                        <textarea id="references" name="references" rows="2" placeholder="Previous employers or professional references"></textarea>
                    </div>
                    <button type="button" class="btn btn-primary next-step-btn">Proceed to Next Step</button>
                    <button type="button" class="btn btn-secondary prev-step-btn">Previous Step</button>
                </div>
                
                <div id="step5" class="form-step hidden">
                    <h2>Final Details</h2>
                    <div class="mb-4">
                        <label for="yearsExperience">Years of Experience:</label>
                        <input type="number" id="yearsExperience" name="yearsExperience" min="0" required placeholder="e.g., 5">
                    </div>
                    <div class="mb-4">
                        <label for="specialization">Specialization (e.g., Engine, Electrical):</label>
                        <input type="text" id="specialization" name="specialization" placeholder="Engine Repair, Electrical Diagnostics">
                    </div>
                     <div class="mb-4">
                        <label for="languageFluency">Language Fluency:</label>
                        <textarea id="languageFluency" name="languageFluency" rows="2" placeholder="List fluent languages, e.g., Hindi, English"></textarea>
                    </div>
                    <div class="mb-4">
                        <label>Car Companies Serviced:</label>
                        <div class="relative">
                            <input type="text" id="carCompanySearch" placeholder="Type to search e.g., Maruti, Honda">
                            <ul id="carCompanyDropdown" class="absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto hidden"></ul>
                        </div>
                        <div id="selectedCarBrands" class="selected-items-container mt-2"></div>
                        <input type="hidden" id="hiddenCarCompanies" name="selectedCarCompanies">
                    </div>
                    <h2 class="mt-6">Terms & Conditions</h2>
                    <div class="mb-4">
                        <label class="inline-flex items-center"><input type="checkbox" id="agreeTerms" name="agreeTerms" required class="form-checkbox"><span class="ml-2">I agree to the <a href="terms.html" class="text-primary hover:underline">Terms of Service</a>.</span></label>
                    </div>
                    <div class="mb-4">
                        <label class="inline-flex items-center"><input type="checkbox" id="confirmAccuracy" name="confirmAccuracy" required class="form-checkbox"><span class="ml-2">I confirm all information is accurate.</span></label>
                    </div>
                    <button type="submit" class="btn btn-primary">Register</button>
                    <button type="button" class="btn btn-secondary prev-step-btn">Previous Step</button>
                </div>
            </form>
        </div>
    </div>

    <div id="messageBox" class="message-box hidden">
        <div class="message-box-content">
            <p id="messageBoxText"></p>
            <button id="messageBoxClose" class="btn btn-primary">OK</button>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- THEME & NAV JAVASCRIPT (Copied from index.html) ---
        const ThemeManager = {
            init() {
                this.themeToggle = document.getElementById('theme-toggle');
                if (!this.themeToggle) return;
                this.themeIcon = this.themeToggle.querySelector('i');
                this.htmlEl = document.documentElement;
                
                const savedTheme = localStorage.getItem('theme') || 'dark';
                this.applyTheme(savedTheme);

                this.themeToggle.addEventListener('click', () => this.toggleTheme());
            },
            applyTheme(theme) {
                this.htmlEl.classList.remove('light', 'dark');
                this.htmlEl.classList.add(theme);
                this.themeIcon.className = `fas fa-${theme === 'dark' ? 'moon' : 'sun'}`;
            },
            toggleTheme() {
                const newTheme = this.htmlEl.classList.contains('dark') ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                this.applyTheme(newTheme);
            }
        };

        const MobileMenu = {
            init() {
                this.menuButton = document.querySelector('.mobile-menu-button');
                this.navSlider = document.querySelector('.mobile-nav-slider');
                this.overlay = document.querySelector('.mobile-nav-overlay');
                this.closeButton = document.querySelector('.mobile-menu-close');
                this.navLinks = document.querySelectorAll('.mobile-nav-slider .nav-link');
                
                if (!this.menuButton) return;

                this.menuButton.addEventListener('click', () => this.open());
                this.closeButton.addEventListener('click', () => this.close());
                this.overlay.addEventListener('click', () => this.close());
                this.navLinks.forEach(link => link.addEventListener('click', () => this.close()));
            },
            open() { this.navSlider.classList.add('open'); this.overlay.classList.add('visible'); },
            close() { this.navSlider.classList.remove('open'); this.overlay.classList.remove('visible'); }
        };

        const NavScroller = {
            init() {
                this.header = document.querySelector('header');
                if(!this.header) return;
                window.addEventListener('scroll', () => this.handleHeaderStyle());
                this.handleHeaderStyle();
            },
            handleHeaderStyle() {
                this.header.classList.toggle('scrolled', window.scrollY > 50);
            }
        };
        
        ThemeManager.init();
        MobileMenu.init();
        NavScroller.init();

        // --- FORM LOGIC (Adapted from original formmechanic.html) ---
        const form = document.getElementById('mechanicRegistrationForm');
        const formSteps = document.querySelectorAll('.form-step');
        const nextButtons = document.querySelectorAll('.next-step-btn');
        const prevButtons = document.querySelectorAll('.prev-step-btn');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const formSubheading = document.getElementById('formSubheading');

        const carCompanySearchInput = document.getElementById('carCompanySearch');
        const carCompanyDropdown = document.getElementById('carCompanyDropdown');
        const selectedCarBrandsContainer = document.getElementById('selectedCarBrands');
        const hiddenCarCompaniesInput = document.getElementById('hiddenCarCompanies');

        const messageBox = document.getElementById('messageBox');
        const messageBoxText = document.getElementById('messageBoxText');
        const messageBoxCloseButton = document.getElementById('messageBoxClose');

        const locationInput = document.getElementById('location');
        const getLocationBtn = document.getElementById('getLocationBtn');
        const locationError = document.getElementById('locationError');
        const toolsOwnedCheckboxes = document.querySelectorAll('input[name="toolsOwned"]');
        const selectedToolsDisplay = document.getElementById('selectedToolsDisplay');
        const hiddenToolsOwnedInput = document.getElementById('hiddenToolsOwned');

        let currentStep = 0;
        const totalSteps = formSteps.length;
        let allFormData = {}; 

        const allCarCompanies = ['Maruti Suzuki', 'Tata Motors', 'Mahindra', 'Hyundai', 'Honda', 'Toyota', 'Kia', 'MG Motor', 'Skoda', 'Volkswagen', 'Renault', 'Nissan', 'Jeep', 'Audi', 'BMW', 'Mercedes-Benz', 'Volvo', 'Land Rover', 'Porsche', 'Ferrari', 'Lamborghini', 'Rolls-Royce', 'Bentley', 'Aston Martin', 'Maserati', 'Jaguar', 'Lexus', 'Mini', 'Datsun', 'Fiat', 'Mitsubishi', 'Chevrolet', 'Ford'].sort();
        let selectedCarCompanies = new Set();
        let selectedTools = new Set();

        const GOOGLE_SHEET_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbywx7o_bMFYXM6dWY39YFAWbjJBcz5s3BN5JZwfMypv0HMxztqoSqDRXX64hexPmdhb/exec';
        
        function showMessageBox(message, callback = null) {
            messageBoxText.textContent = message;
            messageBox.classList.remove('hidden');
            messageBoxCloseButton.onclick = () => {
                messageBox.classList.add('hidden');
                if (callback) callback();
            };
        }

        function updateProgress() {
            const progressPercentage = (currentStep / (totalSteps - 1)) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `Step ${currentStep + 1} of ${totalSteps}`;
            const subheadings = [ 'Personal Details', 'Contact & Verification', 'Service Capabilities', 'Professional & Legal', 'Final Details & Terms' ];
            formSubheading.textContent = `Step ${currentStep + 1}: ${subheadings[currentStep]}`;
        }

        function showStep(stepIndex) {
            formSteps.forEach((step, index) => {
                step.classList.toggle('active', index === stepIndex);
                step.classList.toggle('hidden', index !== stepIndex);
            });
            currentStep = stepIndex;
            updateProgress();
        }

        function validateCurrentStep() {
            const currentFormStepElement = formSteps[currentStep];
            let isValid = true;
            const requiredInputs = currentFormStepElement.querySelectorAll('[required]');
            for (const input of requiredInputs) {
                if (!input.checkValidity()) {
                    isValid = false;
                    // Using a custom message box instead of the browser's default
                    showMessageBox(`Please fill out the '${input.labels[0].textContent}' field correctly.`);
                    break; 
                }
            }
            return isValid;
        }

        nextButtons.forEach(button => button.addEventListener('click', () => {
            if (validateCurrentStep()) showStep(currentStep + 1);
        }));
        prevButtons.forEach(button => button.addEventListener('click', () => showStep(currentStep - 1)));

        // Location Logic
        getLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => locationInput.value = `${pos.coords.latitude}, ${pos.coords.longitude}`,
                    () => locationError.textContent = "Could not get location. Please enter manually."
                );
            } else {
                locationError.textContent = "Geolocation not supported.";
            }
        });

        // Tag selection logic for Tools
        toolsOwnedCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                e.target.checked ? selectedTools.add(e.target.value) : selectedTools.delete(e.target.value);
                renderSelectedItems(selectedTools, selectedToolsDisplay, 'tool', 'No tools selected');
                hiddenToolsOwnedInput.value = JSON.stringify(Array.from(selectedTools));
            });
        });
        selectedToolsDisplay.addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (button) {
                const tool = button.dataset.item;
                selectedTools.delete(tool);
                document.querySelector(`input[name="toolsOwned"][value="${tool}"]`).checked = false;
                renderSelectedItems(selectedTools, selectedToolsDisplay, 'tool', 'No tools selected');
                 hiddenToolsOwnedInput.value = JSON.stringify(Array.from(selectedTools));
            }
        });

        // Tag selection logic for Car Brands
        const renderDropdown = (term = '') => {
            carCompanyDropdown.innerHTML = '';
            const filtered = allCarCompanies.filter(c => c.toLowerCase().includes(term.toLowerCase()) && !selectedCarCompanies.has(c));
            filtered.forEach(c => {
                const li = document.createElement('li');
                li.textContent = c;
                li.className = 'p-2 cursor-pointer hover:bg-accent';
                li.addEventListener('click', () => {
                    selectedCarCompanies.add(c);
                    renderSelectedItems(selectedCarCompanies, selectedCarBrandsContainer, 'company', 'No companies selected');
                    hiddenCarCompaniesInput.value = JSON.stringify(Array.from(selectedCarCompanies));
                    carCompanySearchInput.value = '';
                    carCompanyDropdown.classList.add('hidden');
                });
                carCompanyDropdown.appendChild(li);
            });
            carCompanyDropdown.classList.toggle('hidden', filtered.length === 0);
        };
        carCompanySearchInput.addEventListener('input', (e) => renderDropdown(e.target.value));
        document.addEventListener('click', (e) => {
            if (!carCompanySearchInput.contains(e.target) && !carCompanyDropdown.contains(e.target)) {
                carCompanyDropdown.classList.add('hidden');
            }
        });
        selectedCarBrandsContainer.addEventListener('click', (e) => {
             const button = e.target.closest('button');
            if (button) {
                const company = button.dataset.item;
                selectedCarCompanies.delete(company);
                renderSelectedItems(selectedCarCompanies, selectedCarBrandsContainer, 'company', 'No companies selected');
                hiddenCarCompaniesInput.value = JSON.stringify(Array.from(selectedCarCompanies));
            }
        });

        function renderSelectedItems(itemSet, container, dataAttribute, emptyText) {
            container.innerHTML = '';
            if (itemSet.size === 0) {
                container.innerHTML = `<span class="text-sm text-muted-foreground">${emptyText}</span>`;
            } else {
                itemSet.forEach(item => {
                    const tag = document.createElement('span');
                    tag.className = 'selected-item-tag';
                    tag.innerHTML = `${item} <button type="button" data-item="${item}">&times;</button>`;
                    container.appendChild(tag);
                });
            }
        }
        
        // Form Submission
        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            if (!validateCurrentStep()) return;

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            data.selectedTools = JSON.parse(hiddenToolsOwnedInput.value || '[]');
            data.selectedCarCompanies = JSON.parse(hiddenCarCompaniesInput.value || '[]');
            
            console.log('Final Data:', data);

            try {
                const response = await fetch(GOOGLE_SHEET_WEB_APP_URL, {
                    method: 'POST', mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });
                showMessageBox('Registration successful!', () => {
                    form.reset();
                    selectedTools.clear();
                    selectedCarCompanies.clear();
                    renderSelectedItems(selectedTools, selectedToolsDisplay, 'tool', 'No tools selected');
                    renderSelectedItems(selectedCarCompanies, selectedCarBrandsContainer, 'company', 'No companies selected');
                    showStep(0);
                });
            } catch (error) {
                console.error('Error submitting form:', error);
                showMessageBox('Registration failed. Please try again.');
            }
        });

        // Initial render
        showStep(0);
    });
    </script>
</body>
</html>
